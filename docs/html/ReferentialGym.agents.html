
<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <title>ReferentialGym.agents package &#8212; ReferentialGym  documentation</title>
    <link rel="stylesheet" href="_static/classic.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="_static/language_data.js"></script>
    
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="ReferentialGym.datasets package" href="ReferentialGym.datasets.html" />
    <link rel="prev" title="ReferentialGym package" href="ReferentialGym.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="ReferentialGym.datasets.html" title="ReferentialGym.datasets package"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="ReferentialGym.html" title="ReferentialGym package"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">ReferentialGym  documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="modules.html" >ReferentialGym</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="ReferentialGym.html" accesskey="U">ReferentialGym package</a> &#187;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="referentialgym-agents-package">
<h1>ReferentialGym.agents package<a class="headerlink" href="#referentialgym-agents-package" title="Permalink to this headline">¶</a></h1>
<div class="section" id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="module-ReferentialGym.agents.basic_cnn_listener">
<span id="referentialgym-agents-basic-cnn-listener-module"></span><h2>ReferentialGym.agents.basic_cnn_listener module<a class="headerlink" href="#module-ReferentialGym.agents.basic_cnn_listener" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="ReferentialGym.agents.basic_cnn_listener.BasicCNNListener">
<em class="property">class </em><code class="sig-prename descclassname">ReferentialGym.agents.basic_cnn_listener.</code><code class="sig-name descname">BasicCNNListener</code><span class="sig-paren">(</span><em class="sig-param">kwargs</em>, <em class="sig-param">obs_shape</em>, <em class="sig-param">vocab_size=100</em>, <em class="sig-param">max_sentence_length=10</em><span class="sig-paren">)</span><a class="headerlink" href="#ReferentialGym.agents.basic_cnn_listener.BasicCNNListener" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#ReferentialGym.agents.listener.Listener" title="ReferentialGym.agents.listener.Listener"><code class="xref py py-class docutils literal notranslate"><span class="pre">ReferentialGym.agents.listener.Listener</span></code></a></p>
<dl class="method">
<dt id="ReferentialGym.agents.basic_cnn_listener.BasicCNNListener.reset">
<code class="sig-name descname">reset</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#ReferentialGym.agents.basic_cnn_listener.BasicCNNListener.reset" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="ReferentialGym.agents.basic_cnn_listener.BasicCNNListener._compute_tau">
<code class="sig-name descname">_compute_tau</code><span class="sig-paren">(</span><em class="sig-param">tau0</em><span class="sig-paren">)</span><a class="headerlink" href="#ReferentialGym.agents.basic_cnn_listener.BasicCNNListener._compute_tau" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="ReferentialGym.agents.basic_cnn_listener.BasicCNNListener._sense">
<code class="sig-name descname">_sense</code><span class="sig-paren">(</span><em class="sig-param">stimuli</em>, <em class="sig-param">sentences=None</em><span class="sig-paren">)</span><a class="headerlink" href="#ReferentialGym.agents.basic_cnn_listener.BasicCNNListener._sense" title="Permalink to this definition">¶</a></dt>
<dd><p>Infers features from the stimuli that have been provided.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>stimuli</strong> – Tensor of shape <cite>(batch_size, *self.obs_shape)</cite>. 
Make sure to shuffle the stimuli so that the order does not give away the target.</p></li>
<li><p><strong>sentences</strong> – None or Tensor of shape <cite>(batch_size, max_sentence_length, vocab_size)</cite> containing the padded sequence of (potentially one-hot-encoded) symbols.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>features: Tensor of shape <a href="#id1"><span class="problematic" id="id2">`</span></a>(batch_size, <a href="#id3"><span class="problematic" id="id4">*</span></a>(self.obs_shape[:2]), feature_dim).</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="ReferentialGym.agents.basic_cnn_listener.BasicCNNListener._reason">
<code class="sig-name descname">_reason</code><span class="sig-paren">(</span><em class="sig-param">sentences</em>, <em class="sig-param">features</em><span class="sig-paren">)</span><a class="headerlink" href="#ReferentialGym.agents.basic_cnn_listener.BasicCNNListener._reason" title="Permalink to this definition">¶</a></dt>
<dd><p>Reasons about the features and sentences to yield the target-prediction logits.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sentences</strong> – Tensor of shape <cite>(batch_size, max_sentence_length, vocab_size)</cite> containing the padded sequence of (potentially one-hot-encoded) symbols.</p></li>
<li><p><strong>features</strong> – Tensor of shape <cite>(batch_size, *self.obs_shape[:2], feature_dim)</cite>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p>decision_logits: Tensor of shape <cite>(batch_size, self.obs_shape[1])</cite> containing the target-prediction logits.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="ReferentialGym.agents.basic_cnn_listener.BasicCNNListener._utter">
<code class="sig-name descname">_utter</code><span class="sig-paren">(</span><em class="sig-param">features</em>, <em class="sig-param">sentences</em><span class="sig-paren">)</span><a class="headerlink" href="#ReferentialGym.agents.basic_cnn_listener.BasicCNNListener._utter" title="Permalink to this definition">¶</a></dt>
<dd><p>Reasons about the features and the listened sentences to yield the sentences to utter back.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>features</strong> – Tensor of shape <cite>(batch_size, *self.obs_shape[:2], feature_dim)</cite>.</p></li>
<li><p><strong>sentences</strong> – Tensor of shape <cite>(batch_size, max_sentence_length, vocab_size)</cite> containing the padded sequence of (potentially one-hot-encoded) symbols.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p>logits: Tensor of shape <cite>(batch_size, max_sentence_length, vocab_size)</cite> containing the padded sequence of logits.</p></li>
<li><p>sentences: Tensor of shape <cite>(batch_size, max_sentence_length, vocab_size)</cite> containing the padded sequence of one-hot-encoded symbols.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-ReferentialGym.agents.basic_cnn_speaker">
<span id="referentialgym-agents-basic-cnn-speaker-module"></span><h2>ReferentialGym.agents.basic_cnn_speaker module<a class="headerlink" href="#module-ReferentialGym.agents.basic_cnn_speaker" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="ReferentialGym.agents.basic_cnn_speaker.BasicCNNSpeaker">
<em class="property">class </em><code class="sig-prename descclassname">ReferentialGym.agents.basic_cnn_speaker.</code><code class="sig-name descname">BasicCNNSpeaker</code><span class="sig-paren">(</span><em class="sig-param">kwargs</em>, <em class="sig-param">obs_shape</em>, <em class="sig-param">vocab_size=100</em>, <em class="sig-param">max_sentence_length=10</em><span class="sig-paren">)</span><a class="headerlink" href="#ReferentialGym.agents.basic_cnn_speaker.BasicCNNSpeaker" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#ReferentialGym.agents.speaker.Speaker" title="ReferentialGym.agents.speaker.Speaker"><code class="xref py py-class docutils literal notranslate"><span class="pre">ReferentialGym.agents.speaker.Speaker</span></code></a></p>
<dl class="method">
<dt id="ReferentialGym.agents.basic_cnn_speaker.BasicCNNSpeaker.reset">
<code class="sig-name descname">reset</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#ReferentialGym.agents.basic_cnn_speaker.BasicCNNSpeaker.reset" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="ReferentialGym.agents.basic_cnn_speaker.BasicCNNSpeaker._compute_tau">
<code class="sig-name descname">_compute_tau</code><span class="sig-paren">(</span><em class="sig-param">tau0</em><span class="sig-paren">)</span><a class="headerlink" href="#ReferentialGym.agents.basic_cnn_speaker.BasicCNNSpeaker._compute_tau" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="ReferentialGym.agents.basic_cnn_speaker.BasicCNNSpeaker._sense">
<code class="sig-name descname">_sense</code><span class="sig-paren">(</span><em class="sig-param">stimuli</em>, <em class="sig-param">sentences=None</em><span class="sig-paren">)</span><a class="headerlink" href="#ReferentialGym.agents.basic_cnn_speaker.BasicCNNSpeaker._sense" title="Permalink to this definition">¶</a></dt>
<dd><p>Infers features from the stimuli that have been provided.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>stimuli</strong> – Tensor of shape <cite>(batch_size, *self.obs_shape)</cite>. 
<cite>stimuli[:, 0]</cite> is assumed as the target stimulus, while the others are distractors, if any.</p></li>
<li><p><strong>sentences</strong> – None or Tensor of shape <cite>(batch_size, max_sentence_length, vocab_size)</cite> containing the padded sequence of (potentially one-hot-encoded) symbols.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>features: Tensor of shape <a href="#id5"><span class="problematic" id="id6">`</span></a>(batch_size, <a href="#id7"><span class="problematic" id="id8">*</span></a>(self.obs_shape[:2]), feature_dim).</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="ReferentialGym.agents.basic_cnn_speaker.BasicCNNSpeaker._utter">
<code class="sig-name descname">_utter</code><span class="sig-paren">(</span><em class="sig-param">features</em>, <em class="sig-param">sentences=None</em><span class="sig-paren">)</span><a class="headerlink" href="#ReferentialGym.agents.basic_cnn_speaker.BasicCNNSpeaker._utter" title="Permalink to this definition">¶</a></dt>
<dd><p>Reasons about the features and the listened sentences, if multi_round, to yield the sentences to utter back.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>features</strong> – Tensor of shape <cite>(batch_size, *self.obs_shape[:2], feature_dim)</cite>.</p></li>
<li><p><strong>sentences</strong> – None, or Tensor of shape <cite>(batch_size, max_sentence_length, vocab_size)</cite> containing the padded sequence of (potentially one-hot-encoded) symbols.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p>logits: Tensor of shape <cite>(batch_size, max_sentence_length, vocab_size)</cite> containing the padded sequence of logits.</p></li>
<li><p>sentences: Tensor of shape <cite>(batch_size, max_sentence_length, vocab_size)</cite> containing the padded sequence of one-hot-encoded symbols.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-ReferentialGym.agents.caption_speaker">
<span id="referentialgym-agents-caption-speaker-module"></span><h2>ReferentialGym.agents.caption_speaker module<a class="headerlink" href="#module-ReferentialGym.agents.caption_speaker" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="ReferentialGym.agents.caption_speaker.CaptionSpeaker">
<em class="property">class </em><code class="sig-prename descclassname">ReferentialGym.agents.caption_speaker.</code><code class="sig-name descname">CaptionSpeaker</code><span class="sig-paren">(</span><em class="sig-param">kwargs</em>, <em class="sig-param">obs_shape</em>, <em class="sig-param">vocab_size=100</em>, <em class="sig-param">max_sentence_length=10</em><span class="sig-paren">)</span><a class="headerlink" href="#ReferentialGym.agents.caption_speaker.CaptionSpeaker" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#ReferentialGym.agents.speaker.Speaker" title="ReferentialGym.agents.speaker.Speaker"><code class="xref py py-class docutils literal notranslate"><span class="pre">ReferentialGym.agents.speaker.Speaker</span></code></a></p>
<dl class="method">
<dt id="ReferentialGym.agents.caption_speaker.CaptionSpeaker.reset">
<code class="sig-name descname">reset</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#ReferentialGym.agents.caption_speaker.CaptionSpeaker.reset" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="ReferentialGym.agents.caption_speaker.CaptionSpeaker._compute_tau">
<code class="sig-name descname">_compute_tau</code><span class="sig-paren">(</span><em class="sig-param">tau0</em><span class="sig-paren">)</span><a class="headerlink" href="#ReferentialGym.agents.caption_speaker.CaptionSpeaker._compute_tau" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="ReferentialGym.agents.caption_speaker.CaptionSpeaker._sense">
<code class="sig-name descname">_sense</code><span class="sig-paren">(</span><em class="sig-param">stimuli</em>, <em class="sig-param">sentences=None</em><span class="sig-paren">)</span><a class="headerlink" href="#ReferentialGym.agents.caption_speaker.CaptionSpeaker._sense" title="Permalink to this definition">¶</a></dt>
<dd><p>Infers features from the stimuli that have been provided.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>stimuli</strong> – Tensor of shape <cite>(batch_size, *self.obs_shape)</cite>. 
<cite>stimuli[:, 0]</cite> is assumed as the target stimulus, while the others are distractors, if any.</p></li>
<li><p><strong>sentences</strong> – None or Tensor of shape <cite>(batch_size, max_sentence_length, vocab_size)</cite> containing the padded sequence of (potentially one-hot-encoded) symbols.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>features: Tensor of shape <a href="#id9"><span class="problematic" id="id10">`</span></a>(batch_size, <a href="#id11"><span class="problematic" id="id12">*</span></a>(self.obs_shape[:2]), feature_dim).</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="ReferentialGym.agents.caption_speaker.CaptionSpeaker._utter">
<code class="sig-name descname">_utter</code><span class="sig-paren">(</span><em class="sig-param">features</em>, <em class="sig-param">sentences=None</em><span class="sig-paren">)</span><a class="headerlink" href="#ReferentialGym.agents.caption_speaker.CaptionSpeaker._utter" title="Permalink to this definition">¶</a></dt>
<dd><p>Reasons about the features and the listened sentences, if multi_round, to yield the sentences to utter back.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>features</strong> – Tensor of shape <cite>(batch_size, *self.obs_shape[:2], feature_dim)</cite>.</p></li>
<li><p><strong>sentences</strong> – None, or Tensor of shape <cite>(batch_size, max_sentence_length, vocab_size)</cite> containing the padded sequence of (potentially one-hot-encoded) symbols.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p>logits: Tensor of shape <cite>(batch_size, max_sentence_length, vocab_size)</cite> containing the padded sequence of logits.</p></li>
<li><p>sentences: Tensor of shape <cite>(batch_size, max_sentence_length, vocab_size)</cite> containing the padded sequence of one-hot-encoded symbols.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-ReferentialGym.agents.listener">
<span id="referentialgym-agents-listener-module"></span><h2>ReferentialGym.agents.listener module<a class="headerlink" href="#module-ReferentialGym.agents.listener" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="ReferentialGym.agents.listener.Listener">
<em class="property">class </em><code class="sig-prename descclassname">ReferentialGym.agents.listener.</code><code class="sig-name descname">Listener</code><span class="sig-paren">(</span><em class="sig-param">obs_shape</em>, <em class="sig-param">vocab_size=100</em>, <em class="sig-param">max_sentence_length=10</em>, <em class="sig-param">obverter_training=False</em><span class="sig-paren">)</span><a class="headerlink" href="#ReferentialGym.agents.listener.Listener" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">torch.nn.modules.module.Module</span></code></p>
<dl class="method">
<dt id="ReferentialGym.agents.listener.Listener.reset">
<code class="sig-name descname">reset</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#ReferentialGym.agents.listener.Listener.reset" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="ReferentialGym.agents.listener.Listener._reset_rnn_states">
<code class="sig-name descname">_reset_rnn_states</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#ReferentialGym.agents.listener.Listener._reset_rnn_states" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="ReferentialGym.agents.listener.Listener._tidyup">
<code class="sig-name descname">_tidyup</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#ReferentialGym.agents.listener.Listener._tidyup" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="ReferentialGym.agents.listener.Listener._compute_tau">
<code class="sig-name descname">_compute_tau</code><span class="sig-paren">(</span><em class="sig-param">tau0</em><span class="sig-paren">)</span><a class="headerlink" href="#ReferentialGym.agents.listener.Listener._compute_tau" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="ReferentialGym.agents.listener.Listener._sense">
<code class="sig-name descname">_sense</code><span class="sig-paren">(</span><em class="sig-param">stimuli</em>, <em class="sig-param">sentences=None</em><span class="sig-paren">)</span><a class="headerlink" href="#ReferentialGym.agents.listener.Listener._sense" title="Permalink to this definition">¶</a></dt>
<dd><p>Infers features from the stimuli that have been provided.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>stimuli</strong> – Tensor of shape <cite>(batch_size, *self.obs_shape)</cite>. 
Make sure to shuffle the stimuli so that the order does not give away the target.</p></li>
<li><p><strong>sentences</strong> – None or Tensor of shape <cite>(batch_size, max_sentence_length, vocab_size)</cite> containing the padded sequence of (potentially one-hot-encoded) symbols.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>features: Tensor of shape <a href="#id13"><span class="problematic" id="id14">`</span></a>(batch_size, <a href="#id15"><span class="problematic" id="id16">*</span></a>(self.obs_shape[:2]), feature_dim).</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="ReferentialGym.agents.listener.Listener._reason">
<code class="sig-name descname">_reason</code><span class="sig-paren">(</span><em class="sig-param">sentences</em>, <em class="sig-param">features</em><span class="sig-paren">)</span><a class="headerlink" href="#ReferentialGym.agents.listener.Listener._reason" title="Permalink to this definition">¶</a></dt>
<dd><p>Reasons about the features and sentences to yield the target-prediction logits.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sentences</strong> – Tensor of shape <cite>(batch_size, max_sentence_length, vocab_size)</cite> containing the padded sequence of (potentially one-hot-encoded) symbols.</p></li>
<li><p><strong>features</strong> – Tensor of shape <cite>(batch_size, *self.obs_shape[:2], feature_dim)</cite>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p>decision_logits: Tensor of shape <cite>(batch_size, self.obs_shape[1])</cite> containing the target-prediction logits.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="ReferentialGym.agents.listener.Listener._utter">
<code class="sig-name descname">_utter</code><span class="sig-paren">(</span><em class="sig-param">features</em>, <em class="sig-param">sentences</em><span class="sig-paren">)</span><a class="headerlink" href="#ReferentialGym.agents.listener.Listener._utter" title="Permalink to this definition">¶</a></dt>
<dd><p>Reasons about the features and the listened sentences to yield the sentences to utter back.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>features</strong> – Tensor of shape <cite>(batch_size, *self.obs_shape[:2], feature_dim)</cite>.</p></li>
<li><p><strong>sentences</strong> – Tensor of shape <cite>(batch_size, max_sentence_length, vocab_size)</cite> containing the padded sequence of (potentially one-hot-encoded) symbols.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p>logits: Tensor of shape <cite>(batch_size, max_sentence_length, vocab_size)</cite> containing the padded sequence of logits.</p></li>
<li><p>sentences: Tensor of shape <cite>(batch_size, max_sentence_length, vocab_size)</cite> containing the padded sequence of one-hot-encoded symbols.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="ReferentialGym.agents.listener.Listener.forward">
<code class="sig-name descname">forward</code><span class="sig-paren">(</span><em class="sig-param">sentences</em>, <em class="sig-param">stimuli</em>, <em class="sig-param">multi_round=False</em>, <em class="sig-param">graphtype='straight_through_gumbel_softmax'</em>, <em class="sig-param">tau0=0.2</em><span class="sig-paren">)</span><a class="headerlink" href="#ReferentialGym.agents.listener.Listener.forward" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sentences</strong> – Tensor of shape <cite>(batch_size, max_sentence_length, vocab_size)</cite> containing the padded sequence of (potentially one-hot-encoded) symbols.</p></li>
<li><p><strong>stimuli</strong> – Tensor of shape <cite>(batch_size, *self.obs_shape)</cite>. 
Make sure to shuffle the stimuli so that the order does not give away the target.</p></li>
<li><p><strong>multi_round</strong> – Boolean defining whether to utter a sentence back or not.</p></li>
<li><p><strong>graphtype</strong> – String defining the type of symbols used in the output sentence:
- <cite>‘categorical’</cite>: one-hot-encoded symbols.
- <cite>‘gumbel_softmax’</cite>: continuous relaxation of a categorical distribution.
- <cite>‘straight_through_gumbel_softmax’</cite>: improved continuous relaxation…
- <cite>‘obverter’</cite>: obverter training scheme…</p></li>
<li><p><strong>tau0</strong> – </p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-ReferentialGym.agents.obverter_agent">
<span id="referentialgym-agents-obverter-agent-module"></span><h2>ReferentialGym.agents.obverter_agent module<a class="headerlink" href="#module-ReferentialGym.agents.obverter_agent" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="ReferentialGym.agents.obverter_agent.ObverterAgent">
<em class="property">class </em><code class="sig-prename descclassname">ReferentialGym.agents.obverter_agent.</code><code class="sig-name descname">ObverterAgent</code><span class="sig-paren">(</span><em class="sig-param">kwargs</em>, <em class="sig-param">obs_shape</em>, <em class="sig-param">vocab_size=100</em>, <em class="sig-param">max_sentence_length=10</em><span class="sig-paren">)</span><a class="headerlink" href="#ReferentialGym.agents.obverter_agent.ObverterAgent" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#ReferentialGym.agents.listener.Listener" title="ReferentialGym.agents.listener.Listener"><code class="xref py py-class docutils literal notranslate"><span class="pre">ReferentialGym.agents.listener.Listener</span></code></a></p>
<dl class="method">
<dt id="ReferentialGym.agents.obverter_agent.ObverterAgent.reset">
<code class="sig-name descname">reset</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#ReferentialGym.agents.obverter_agent.ObverterAgent.reset" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="ReferentialGym.agents.obverter_agent.ObverterAgent._tidyup">
<code class="sig-name descname">_tidyup</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#ReferentialGym.agents.obverter_agent.ObverterAgent._tidyup" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="ReferentialGym.agents.obverter_agent.ObverterAgent._sense">
<code class="sig-name descname">_sense</code><span class="sig-paren">(</span><em class="sig-param">stimuli</em>, <em class="sig-param">sentences=None</em><span class="sig-paren">)</span><a class="headerlink" href="#ReferentialGym.agents.obverter_agent.ObverterAgent._sense" title="Permalink to this definition">¶</a></dt>
<dd><p>Infers features from the stimuli that have been provided.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>stimuli</strong> – Tensor of shape <cite>(batch_size, *self.obs_shape)</cite>. 
Make sure to shuffle the stimuli so that the order does not give away the target.</p></li>
<li><p><strong>sentences</strong> – None or Tensor of shape <cite>(batch_size, max_sentence_length, vocab_size)</cite> containing the padded sequence of (potentially one-hot-encoded) symbols.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>features: Tensor of shape <a href="#id17"><span class="problematic" id="id18">`</span></a>(batch_size, <a href="#id19"><span class="problematic" id="id20">*</span></a>(self.obs_shape[:2]), feature_dim).</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="ReferentialGym.agents.obverter_agent.ObverterAgent._reason">
<code class="sig-name descname">_reason</code><span class="sig-paren">(</span><em class="sig-param">sentences</em>, <em class="sig-param">features</em><span class="sig-paren">)</span><a class="headerlink" href="#ReferentialGym.agents.obverter_agent.ObverterAgent._reason" title="Permalink to this definition">¶</a></dt>
<dd><p>Reasons about the features and sentences to yield the target-prediction logits.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sentences</strong> – Tensor of shape <cite>(batch_size, max_sentence_length, vocab_size)</cite> containing the padded sequence of (potentially one-hot-encoded) symbols.</p></li>
<li><p><strong>features</strong> – Tensor of shape <cite>(batch_size, *self.obs_shape[:2], feature_dim)</cite>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p>decision_logits: Tensor of shape <cite>(batch_size, self.obs_shape[1])</cite> containing the target-prediction logits.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="ReferentialGym.agents.obverter_agent.ObverterAgent._utter">
<code class="sig-name descname">_utter</code><span class="sig-paren">(</span><em class="sig-param">features</em>, <em class="sig-param">sentences</em><span class="sig-paren">)</span><a class="headerlink" href="#ReferentialGym.agents.obverter_agent.ObverterAgent._utter" title="Permalink to this definition">¶</a></dt>
<dd><p>Reasons about the features and the listened sentences to yield the sentences to utter back.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>features</strong> – Tensor of shape <cite>(batch_size, *self.obs_shape[:2], feature_dim)</cite>.</p></li>
<li><p><strong>sentences</strong> – Tensor of shape <cite>(batch_size, max_sentence_length, vocab_size)</cite> containing the padded sequence of (potentially one-hot-encoded) symbols.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p>logits: Tensor of shape <cite>(batch_size, max_sentence_length, vocab_size)</cite> containing the padded sequence of logits.</p></li>
<li><p>sentences: Tensor of shape <cite>(batch_size, max_sentence_length, vocab_size)</cite> containing the padded sequence of one-hot-encoded symbols.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="ReferentialGym.agents.obverter_agent.ObverterAgent._compute_sentence">
<code class="sig-name descname">_compute_sentence</code><span class="sig-paren">(</span><em class="sig-param">target_idx</em>, <em class="sig-param">symbol_encoder</em>, <em class="sig-param">symbol_processing</em>, <em class="sig-param">symbol_decoder</em>, <em class="sig-param">init_rnn_states=None</em>, <em class="sig-param">vocab_size=10</em>, <em class="sig-param">max_sentence_length=14</em>, <em class="sig-param">nbr_distractors_po=1</em>, <em class="sig-param">operation=&lt;built-in method max of type object&gt;</em>, <em class="sig-param">vocab_stop_idx=0</em><span class="sig-paren">)</span><a class="headerlink" href="#ReferentialGym.agents.obverter_agent.ObverterAgent._compute_sentence" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute sentences using the obverter approach, adapted to referential game variants following the
descriptive approach described in the work of [Choi et al., 2018](<a class="reference external" href="http://arxiv.org/abs/1804.02341">http://arxiv.org/abs/1804.02341</a>).</p>
<p>In descriptive move, <cite>nbr_distractors_po=1</cite> and <cite>target_idx=torch.zeros((batch_size,1))</cite>, 
thus the algorithm behaves exactly like in Choi et al. (2018).
Otherwise, the the likelyhoods for the target stimulus of being chosen by the decision module 
is considered solely and the algorithm aims at maximizing/minimizing (following :param operation:) 
this likelyhood over the sentence’s next word.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>features_embedding</strong> – Tensor of (temporal) features embedding of shape <cite>(batch_size, *self.obs_shape)</cite>.</p></li>
<li><p><strong>target_idx</strong> – Tensor of indices of the target stimuli of shape <cite>(batch_size, 1)</cite>.</p></li>
<li><p><strong>symbol_encoder</strong> – torch.nn.Module used to embed vocabulary indices into vocabulary embeddings.</p></li>
<li><p><strong>symbol_processing</strong> – torch.nn.Module used to generate the sentences.</p></li>
<li><p><strong>symbol_decoder</strong> – torch.nn.Module used to decode the embeddings generated by the <cite>:param symbol_processing:</cite> module.</p></li>
<li><p><strong>init_rnn_states</strong> – None or Tuple of Tensors to initialize the symbol_processing’s rnn states.</p></li>
<li><p><strong>vocab_size</strong> – int, size of the vocabulary.</p></li>
<li><p><strong>max_sentence_length</strong> – int, maximal length for each generated sentences.</p></li>
<li><p><strong>nbr_distractors_po</strong> – int, number of distractors and target, i.e. <a href="#id21"><span class="problematic" id="id22">`</span></a>nbr_distractors+1.</p></li>
<li><p><strong>operation</strong> – Function, expect <cite>torch.max</cite> or <cite>torch.min</cite>.</p></li>
<li><p><strong>vocab_stop_idx</strong> – int, index of the STOP symbol in the vocabulary.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><dl class="simple">
<dt>sentences_idx: List[Tensor] of length <cite>batch_size</cite> with shapes <cite>(1, sentences_lenght[b], 1)</cite> where <cite>b</cite> is the batch index.</dt><dd><p>It represents the indices of the chosen words.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>sentences_logits: List[Tensor] of length <cite>batch_size</cite> with shapes <cite>(1, sentences_lenght[b], vocab_size)</cite> where <cite>b</cite> is the batch index.</dt><dd><p>It represents the logits of words over the decision module’s potential to choose the target stimulus as output.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>sentences_one_hots: List[Tensor] of length <cite>batch_size</cite> with shapes <cite>(1, sentences_lenght[b], vocab_size)</cite> where <cite>b</cite> is the batch index.</dt><dd><p>It represents the sentences as one-hot-encoded word vectors.</p>
</dd>
</dl>
</li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-ReferentialGym.agents.speaker">
<span id="referentialgym-agents-speaker-module"></span><h2>ReferentialGym.agents.speaker module<a class="headerlink" href="#module-ReferentialGym.agents.speaker" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="ReferentialGym.agents.speaker.Speaker">
<em class="property">class </em><code class="sig-prename descclassname">ReferentialGym.agents.speaker.</code><code class="sig-name descname">Speaker</code><span class="sig-paren">(</span><em class="sig-param">obs_shape</em>, <em class="sig-param">vocab_size=100</em>, <em class="sig-param">max_sentence_length=10</em><span class="sig-paren">)</span><a class="headerlink" href="#ReferentialGym.agents.speaker.Speaker" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">torch.nn.modules.module.Module</span></code></p>
<dl class="method">
<dt id="ReferentialGym.agents.speaker.Speaker.reset">
<code class="sig-name descname">reset</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#ReferentialGym.agents.speaker.Speaker.reset" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="ReferentialGym.agents.speaker.Speaker._reset_rnn_states">
<code class="sig-name descname">_reset_rnn_states</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#ReferentialGym.agents.speaker.Speaker._reset_rnn_states" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="ReferentialGym.agents.speaker.Speaker._compute_tau">
<code class="sig-name descname">_compute_tau</code><span class="sig-paren">(</span><em class="sig-param">tau0</em><span class="sig-paren">)</span><a class="headerlink" href="#ReferentialGym.agents.speaker.Speaker._compute_tau" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="ReferentialGym.agents.speaker.Speaker._sense">
<code class="sig-name descname">_sense</code><span class="sig-paren">(</span><em class="sig-param">stimuli</em>, <em class="sig-param">sentences=None</em><span class="sig-paren">)</span><a class="headerlink" href="#ReferentialGym.agents.speaker.Speaker._sense" title="Permalink to this definition">¶</a></dt>
<dd><p>Infers features from the stimuli that have been provided.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>stimuli</strong> – Tensor of shape <cite>(batch_size, *self.obs_shape)</cite>. 
<cite>stimuli[:, 0]</cite> is assumed as the target stimulus, while the others are distractors, if any.</p></li>
<li><p><strong>sentences</strong> – None or Tensor of shape <cite>(batch_size, max_sentence_length, vocab_size)</cite> containing the padded sequence of (potentially one-hot-encoded) symbols.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>features: Tensor of shape <a href="#id23"><span class="problematic" id="id24">`</span></a>(batch_size, <a href="#id25"><span class="problematic" id="id26">*</span></a>(self.obs_shape[:2]), feature_dim).</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="ReferentialGym.agents.speaker.Speaker._utter">
<code class="sig-name descname">_utter</code><span class="sig-paren">(</span><em class="sig-param">features</em>, <em class="sig-param">sentences=None</em><span class="sig-paren">)</span><a class="headerlink" href="#ReferentialGym.agents.speaker.Speaker._utter" title="Permalink to this definition">¶</a></dt>
<dd><p>Reasons about the features and the listened sentences, if multi_round, to yield the sentences to utter back.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>features</strong> – Tensor of shape <cite>(batch_size, *self.obs_shape[:2], feature_dim)</cite>.</p></li>
<li><p><strong>sentences</strong> – None, or Tensor of shape <cite>(batch_size, max_sentence_length, vocab_size)</cite> containing the padded sequence of (potentially one-hot-encoded) symbols.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p>logits: Tensor of shape <cite>(batch_size, max_sentence_length, vocab_size)</cite> containing the padded sequence of logits.</p></li>
<li><p>sentences: Tensor of shape <cite>(batch_size, max_sentence_length, vocab_size)</cite> containing the padded sequence of one-hot-encoded symbols.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="ReferentialGym.agents.speaker.Speaker.forward">
<code class="sig-name descname">forward</code><span class="sig-paren">(</span><em class="sig-param">stimuli</em>, <em class="sig-param">sentences=None</em>, <em class="sig-param">graphtype='straight_through_gumbel_softmax'</em>, <em class="sig-param">tau0=0.2</em>, <em class="sig-param">multi_round=False</em><span class="sig-paren">)</span><a class="headerlink" href="#ReferentialGym.agents.speaker.Speaker.forward" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>stimuli</strong> – Tensor of shape <cite>(batch_size, *self.obs_shape)</cite>. 
<cite>stimuli[:,0]</cite> is assumed as the target stimulus, while the others are distractors, if any.</p></li>
<li><p><strong>graphtype</strong> – String defining the type of symbols used in the output sentence:
- <cite>‘categorical’</cite>: one-hot-encoded symbols.
- <cite>‘gumbel_softmax’</cite>: continuous relaxation of a categorical distribution, following 
- <cite>‘straight_through_gumbel_softmax’</cite>: improved continuous relaxation…
- <cite>‘obverter’</cite>: obverter training scheme…</p></li>
<li><p><strong>tau0</strong> – </p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-ReferentialGym.agents">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-ReferentialGym.agents" title="Permalink to this headline">¶</a></h2>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="index.html">Table of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">ReferentialGym.agents package</a><ul>
<li><a class="reference internal" href="#submodules">Submodules</a></li>
<li><a class="reference internal" href="#module-ReferentialGym.agents.basic_cnn_listener">ReferentialGym.agents.basic_cnn_listener module</a></li>
<li><a class="reference internal" href="#module-ReferentialGym.agents.basic_cnn_speaker">ReferentialGym.agents.basic_cnn_speaker module</a></li>
<li><a class="reference internal" href="#module-ReferentialGym.agents.caption_speaker">ReferentialGym.agents.caption_speaker module</a></li>
<li><a class="reference internal" href="#module-ReferentialGym.agents.listener">ReferentialGym.agents.listener module</a></li>
<li><a class="reference internal" href="#module-ReferentialGym.agents.obverter_agent">ReferentialGym.agents.obverter_agent module</a></li>
<li><a class="reference internal" href="#module-ReferentialGym.agents.speaker">ReferentialGym.agents.speaker module</a></li>
<li><a class="reference internal" href="#module-ReferentialGym.agents">Module contents</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="ReferentialGym.html"
                        title="previous chapter">ReferentialGym package</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="ReferentialGym.datasets.html"
                        title="next chapter">ReferentialGym.datasets package</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/ReferentialGym.agents.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="ReferentialGym.datasets.html" title="ReferentialGym.datasets package"
             >next</a> |</li>
        <li class="right" >
          <a href="ReferentialGym.html" title="ReferentialGym package"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">ReferentialGym  documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="modules.html" >ReferentialGym</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="ReferentialGym.html" >ReferentialGym package</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2019, Kevin Denamganaï.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 2.1.2.
    </div>
  </body>
</html>